/** * Created by 1ka on 3/28/14. */var ZOOMPYCDB = ZOOMPYCDB||{};//создание пространства именZOOMPYCDB.namespace = function (ns_string) {    var parts = ns_string.split('.'),        parent = ZOOMPYCDB,        i;    if (parts[0] === "ZOOMPYCDB") {        parts = parts.slice(1);    }    for (i = 0; i < parts.length; i += 1) {        if (typeof parent[parts[i]] === "undefined") {            parent[parts[i]] = {};        }        parent = parent[parts[i]];    }    return parent;};ZOOMPYCDB.test;ZOOMPYCDB.saveViewsTable = function(td,table,value){	var pos = table.cell( $(td) ).index().column;	//var column = table.column(pos);    var row = table.row( $(td).parent() ).data();    if(row===undefined) return;    if(pos==0) row.name=value;    else row.image=value;    $.ajax({        type: "GET",        url: "http://0.0.0.0:8082/graph_editor/saveView",        data: {view: JSON.stringify(row) },        error: function(xhr, ajaxOptions, thrownError) {            $(document).trigger("unset_loading_cursor");            $(document).trigger("error_message",thrownError);        },        success: function(data){            table.ajax.reload();            $(document).trigger("unset_loading_cursor");            $(document).trigger("config_changed");        }    });};$(document).ready(function(){    var table = $('#table_views').DataTable({        "ajax": "http://0.0.0.0:8082/graph_editor/getViewsData",        "columns": [            { "data": "name" },            { "data": "image" }        ]    } );    table.on("draw",function(){    	$('#table_views tbody td:not(.editable)').editable( function( value ) {    		ZOOMPYCDB.saveViewsTable( this,table,value );		}, { "onblur": function(value){			ZOOMPYCDB.saveViewsTable( this,table,value );		}		});		$('#table_views tbody td').addClass('editable');	});	$('#table_views tbody').on( 'dblclick', 'tr', function (event) {        if ( $(this).hasClass('selected') ) {            $(this).removeClass('selected');        }        else {        	table.$('tr.selected').removeClass('selected');            $(this).addClass('selected');        }    } );    $('#add_view').on( 'click', function () {        $.ajax({            type: "GET",            url: "http://0.0.0.0:8082/graph_editor/addView",            error: function(xhr, ajaxOptions, thrownError) {                $(document).trigger("unset_loading_cursor");                $(document).trigger("error_message",thrownError);            },            success: function(){                table.ajax.reload();                $(document).trigger("unset_loading_cursor");                $(document).trigger("config_changed");            }        });    } );    $('#delete_view').on( 'click', function () {    	var id = table.row('.selected').data().id;        $.ajax({            type: "GET",            url: "http://0.0.0.0:8082/graph_editor/deleteView/"+id,            error: function(xhr, ajaxOptions, thrownError) {                $(document).trigger("unset_loading_cursor");                $(document).trigger("error_message",thrownError);            },            success: function(){                table.ajax.reload();                $(document).trigger("unset_loading_cursor");                $(document).trigger("config_changed");            }        });    } );    $('#select_view').on( 'click', function () {    	var id = table.row('.selected').data().id;        window.location.href = "http://0.0.0.0:8082/graph_editor/edit_view/"+id;    } );});