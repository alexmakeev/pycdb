var selection;$(document).ready(function ($) {    var palette = d3.select("#palette");    var graphmap = d3.select("#graph_map");    var ajax_req = new AjaxRequest();    var palette = new Palette(palette, d3.select("#palette_nodes"));    var graph = new Graph(graphmap);    var object_info = new ObjectInfo();    var logger = new Logger();    $(document).on("config_data_loaded", function (event, conf_nod, conf_rel) {        var data = [conf_nod, conf_rel];        palette.setConfigData(data);        graph.setConfigData(data);        object_info.setConfigData(data);    });    $(document).on("graph_data_loaded", function (event, graph_nod, graph_rel) {        var data = [graph_nod, graph_rel];        graph.setData(data);    })    $(document).on("cid_chosen", function (event, cid) {        graph.setChosenCid(cid);    });    $(document).on("rel_chosen", function (event, rel) {        graph.setChosenRel(rel);    });    $(document).on("add_new_node", function (event, node) {        ajax_req.addNewNode(node);    });    $(document).on("add_node_on_graph", function (event, node) {        graph.addNodeOnGraph(node);    });    $(document).on("add_rel_on_graph", function (event, rel) {        graph.addRelOnGraph(rel);    });    $(document).on("add_new_rel", function (event, rel) {        ajax_req.addNewRel(rel);    })    $(document).on("add_fragment", function (event, fragment) {        ajax_req.addFragment(fragment);    })    $(document).on("add_fragment_on_graph", function (event, fragment) {        graph.addFragmentOnGraph(fragment);    })    $(document).on("refresh_graph", function () {        graph.refreshGraph();    })    $(document).on("zoom_transform", function (event) {        graph.zoomTransform();    })    $(document).on("search_loaded", function (event, data) {        object_info.setSearchWidget(data);    })    $(document).on("object_found", function (event, cid, id) {        graph.selectObject(cid, id);        graph.zoomTo(cid, id);    })    $(document).on("relation_selected", function (event, object) {        graph.deleteSelection();        object_info.selectRelation(object);        ajax_req.loadRelationAttributes(object.cid, object.id);    })    $(document).on("relation_data_loaded", function (event, fields, vals) {        object_info.setRelationConfigData(fields, vals);    })    $(document).on("object_data_loaded", function (event, fields, vals, protos, proto_vals) {        object_info.setObjectConfigData(fields, vals, protos, proto_vals);    })    $(document).on("object_selected", function (event, object) {        graph.deleteSelection();        object_info.selectObject(object);        ajax_req.loadObjectConfigData(object.cid, object.id);    })    $(document).on("save_coords", function (event) {        ajax_req.saveAllGraph(graph.graph_data[0]);    })    $(document).on("objinfo_delete_node", function () {        object_info.deleteNode();    })    $(document).on("delete_node", function (event, object) {        ajax_req.deleteTheNode(object);    })    $(document).on("node_deleted", function (event, node) {        graph.deleteNode(node);    })    $(document).on("objinfo_delete_rel", function () {        object_info.deleteRelation();    })    $(document).on("delete_rel", function (event, relation) {        ajax_req.deleteRelation(relation);    })    $(document).on("rel_deleted", function (event, rel) {        graph.deleteRelation(rel);    })    $(document).on("save_node", function (event) {        ajax_req.saveTheNode(object_info.saveObject(), object_info.getObjectAttributes());        graph.refreshGraph();    })    $(document).on("find_neighbors", function (event, number) {        graph.findAllNeighbors(object_info.object.cid, object_info.object.id, number);    })    $(document).on("save_rel", function (event) {        ajax_req.saveRelation(object_info.getRelationAttrs());    })    $(document).on("set_default_value", function (event, pair) {        object_info.setDefaultValue(pair);    })    $(document).on("keydown", function (e) {        if (e.keyCode === 46) {            if (object_info.object != undefined)                ajax_req.deleteTheNode(object_info.object);            if (object_info.relation != undefined)                ajax_req.deleteRelation(object_info.relation);        }    })    $(document).on("move_selection", function () {        graph.moveSelection();    })    $(document).on("end_move_selection", function () {        graph.endMoveSelection();    })    $(document).on("add_node", function () {        graph.addNode();    })    $(document).on("error_message", function (event, mes) {        logger.printErrorMessage(mes);    });    ajax_req.loadConfigurationData();    ajax_req.loadGraphData();    ajax_req.loadSearchWidget();});